<!DOCTYPE html><html lang="zh-cn,en,default"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>WebSocket 简单介绍 | 断崖上の风's Blog</title><meta name="description" content="WebSocket 简单介绍 - 断崖上的风"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.ico"><link rel="stylesheet" href="/scss/casual.css"><link rel="stylesheet" href="/css/icon.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.css"><link rel="search" type="application/opensearchdescription+xml" href="https://dysdf.github.io/atom.xml" title="断崖上の风's Blog"><meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/atom.xml" title="断崖上の风's Blog" type="application/atom+xml">
</head><body><header><figure style="background-image:url(/image/banner.jpg)" class="site-banner"><div class="site-banner__wrapper"><h3 class="site-banner__title"><a href="/" data-text="断崖上の风's Blog">断崖上の风's Blog</a></h3></div></figure><div class="site-nav"><span class="button-toggle"><span></span></span><div class="nav-list"><div class="nav-item"><a href="/" target="_self" data-text="home">主页</a></div><div class="nav-item"><a href="/archives/" target="_self" data-text="archive">归档</a></div><div class="nav-item"><a href="/about" target="_self" data-text="about">关于</a></div></div><form id="search-form" class="nav-item"><label for="local-search-input" class="trigger-btn"><i class="fa fa-search"></i></label><input type="text" id="local-search-input" name="q" results="0" placeholder="搜索" autocomplete="off" autocorrect="off" required class="search form-control"><i id="local-search-reset" onclick="resetSearch()" class="fa fa-close"></i><div id="local-search-result"></div></form></div></header><div class="main"><div class="content"><div class="post-item"><img src="banner.png" class="banner"><article class="post-article"><div class="post-article__header"><h3 class="post-article__title">WebSocket 简单介绍</h3><div class="post-article__meta"><span class="post-article__date"><i class="fa fa-calendar"></i><span>2021-09-29</span></span><span href="/categories/WebSocket/" class="post-article__category"><i class="fa fa-bookmark"></i><span>WebSocket</span></span><span class="post-article__tags"><i class="fa fa-tags"></i><a href="/tags/%E5%89%8D%E7%AB%AF/">前端</a><a href="/tags/WebSocket/">WebSocket</a><a href="/tags/HTML5/">HTML5</a></span><span class="post-article__review"><i class="fa fa-eye"></i><span><span>阅读次数:</span><span id="busuanzi_value_page_pv">-</span></span></span></div></div><div class="post-content"><blockquote>
<p><code>WebSocket</code> 是一种网络传输协议，可在单个 <code>TCP</code> 连接上进行<code>全双工</code>通信，位于<code>OSI</code>模型的应用层。<code>WebSocket</code>中的握手和<code>HTTP</code>中的握手兼容，使用<code>HTTP</code>中的<code>Upgrade</code>协议头将连接从<code>HTTP</code>升级到<code>WebSocket</code>，这使得<code>WebSocket</code>程序可以更容易的使用现已存在的基础设施。<code>WebSocket</code>协议相比较于<code>HTTP</code>协议成功握手后可以多次进行通讯，直到连接被关闭。</p>
</blockquote>
<span id="more"></span>

<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>WebSocket 是目前比较成熟的技术了，WebSocket 协议为客户端和服务器端之间的实时双向通讯提供了一个选择。其作为 HTML5 的一部分，已经成为国际标准，几乎所有的现代浏览器都已经支持 WebSocket，比如 Firefox，IE，Chrome，Safari，Opera，并且越来越多的服务器框架也支持 WebSocket。</p>
<p>它的最大特点就是，服务器可以主动向客户端推送信息，客户端也可以主动向服务器发送信息，是真正的双向平等对话，属于服务器推送技术的一种。</p>
<p><img src="ws_vs_http.png" alt="WebSocket对比HTTP"></p>
<p>其它特点包括：</p>
<ul>
<li>建立在 TCP 协议之上，服务器端的实现比较容易。</li>
<li>与 HTTP 协议有着良好的兼容性。默认端口同样是 80 和 443，并且握手阶段采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器。</li>
<li>可以发送文本，也可以发送二进制数据。</li>
<li>没有同源限制，客户端可以与任意服务器通信。</li>
</ul>
<p><img src="ws_vs_http_2.jpg" alt="WebSocket对比HTTP"></p>
<h3 id="旧时代的“服务端推送”"><a href="#旧时代的“服务端推送”" class="headerlink" title="旧时代的“服务端推送”"></a>旧时代的“服务端推送”</h3><p>在 WebSocket 出现以前，为了实现“服务器推送”，我们一般采用“长连接” + “轮询”的实现方式。即客户端向服务发起 HTTP 请求，服务器收到请求后不立即响应，而是让连接一直处于挂起状态，等到需要向客户端“推送”消息了，再响应这个连接；客户端收到服务端的 HTTP 响应后，这个 HTTP 连接就断开了，所以客户端就再次发起一个 HTTP 请求，服务端收到后再挂起，如此往复。行为类似于我们小时候玩的<code>“纸杯电话”</code>。</p>
<p>这种方式虽然也能实现服务端的“推送”，但是存在如下致命问题：</p>
<ul>
<li>非全双工通信，同一时刻只能由一端进行数据发送，无法同时进行。</li>
<li>客户端和服务端的每一次通信都要建立一次 TCP 连接，而且无法复用链路，在限制 TCP 连接数的浏览器上，可能会导致正常的 HTTP 请求无法发出。</li>
<li>每次 HTTP 握手也要消耗时间，而且每次通信除了真正的数据部分外，还会携带大量 HTTP Header，信息交换效率极低。</li>
</ul>
<h3 id="新时代的-WebSocket"><a href="#新时代的-WebSocket" class="headerlink" title="新时代的 WebSocket"></a>新时代的 WebSocket</h3><p>相对于传统 HTTP 每次<code>请求-应答</code>都需要客户端与服务端建立连接的模式，WebSocket 是类似 Socket 的 TCP 长连接通讯模式。一旦 WebSocket 连接建立后，后续数据都以帧序列的形式传输。在客户端断开 WebSocket 连接或 Server 端中断连接前，不需要客户端和服务端重新发起连接请求。在海量并发及客户端与服务器交互负载流量大的情况下，极大的节省了网络带宽资源的消耗，有明显的性能优势，且客户端发送和接受消息是在同一个持久连接上发起，实时性优势明显。</p>
<p>对比 HTTP 长连接，WebSocket有如下优点：</p>
<ul>
<li>是真正的全双工方式，建立连接后客户端与服务器端是完全平等的，可以互相主动请求。</li>
<li>Websocket 通过第一个 request 建立了 TCP 连接之后，之后交换的数据都不需要发送 HTTP header 就能交换数据。此外还有<code>多路复用(multiplexing)</code>，不同的URL可以复用同一个WebSocket 连接等功能。</li>
</ul>
<p>这些都是 HTTP 长连接所不具备的。</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p><strong>WebSocket 与 HTTP 相同点</strong></p>
<ul>
<li>都是基于 TCP 协议的，都是可靠性传输协议。</li>
<li>都是应用层协议。</li>
</ul>
<p><strong>WebSocket 与 HTTP 不同点</strong></p>
<ul>
<li>WebSocket 是双向通信协议，模拟 Socket 协议，可以双向发送或接受信息。HTTP 是单向的。</li>
<li>WebSocket 是需要浏览器和服务器握手进行建立连接的。而 HTTP 是浏览器向服务器发起的连接，服务器预先并不知道这个连接。</li>
</ul>
<p><strong>WebSocket 与 HTTP 联系</strong><br>在 WebSocket中，客户端和服务端在建立连接之前，是需要通过 HTTP 协议进行一个握手的动作，握手时，数据是通过 HTTP 传输的。但是握手完成之后，会单独建立一条 TCP 的通信通道进行数据的传送，所以在真正传输时候是不需要 HTTP 协议的。</p>
</div></article></div><div class="post-paginator"><div class="post-links"><div class="post-prev"><a href="/2021/09/29/004.nginx-proxy-websocket/" class="prev">上一篇<span>使用 Nginx 对 WebSocket 做反向代理</span></a></div><div class="post-next"><a href="/2021/09/27/002.browser_architecture_evolution/" class="next">下一篇<span>浏览器架构演进</span></a></div></div></div><div id="uyan_frame"></div></div><div class="sidebar"><div class="social-links"><ul><li><a href="https://github.com/DYSDF" target="_blank" title="github" class="link-github social-link"><i class="fa fa-github"></i></a></li><li><a href="mailto:admin@duan-ya.com" target="_self" title="邮件" class="link-envelope social-link"><i class="fa fa-envelope"></i></a></li><li><a href="/atom.xml" target="_self" title="订阅" class="link-rss social-link"><i class="fa fa-rss"></i></a></li></ul></div><div class="recent-posts widget"><h3 class="widget-title">近期文章</h3><div class="widget-content"><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2022/01/28/006-react-vnode-diff-algorithm/">React vNode Diff算法</a></li><li class="post-list-item"><a class="post-list-link" href="/2022/01/17/005.node-detect-tcp-port/">Node.js探测TCP端口</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/29/004.nginx-proxy-websocket/">使用 Nginx 对 WebSocket 做反向代理</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/29/003.websocket/">WebSocket 简单介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/09/27/002.browser_architecture_evolution/">浏览器架构演进</a></li></ul></div></div><div class="recent-comment widget"><h3 class="widget-title">近期评论</h3><div class="widget-content"><div id="uyan_newcmt_unit"></div></div></div><div class="tag-lists widget"><h3 class="widget-title">标签</h3><div class="widget-content"><div id="tags-ball"><canvas></canvas></div></div></div><div class="archive-lists widget"><h3 class="widget-title">归档</h3><div class="widget-content"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a><span class="archive-list-count">4</span></li></ul></div></div></div></div><footer><div class="copyright"><div class="col-6"><div class="site-info">© 2016 - 2024 <span class="icon icon-heart"></span> <a href="https://dysdf.github.io">断崖上的风</a><span class="sep">/</span><a href="https://hexo.io/" target="_blank">Powered by Hexo</a></div></div><div class="col-6"><div class="site-contact"><div class="social-links"><ul><li><a href="https://github.com/DYSDF" target="_blank" title="github" class="link-github social-link"><i class="fa fa-github"></i></a></li><li><a href="mailto:admin@duan-ya.com" target="_self" title="邮件" class="link-envelope social-link"><i class="fa fa-envelope"></i></a></li><li><a href="/atom.xml" target="_self" title="订阅" class="link-rss social-link"><i class="fa fa-rss"></i></a></li></ul></div></div></div></div></footer><a class="scroll-up"><span class="icon icon-up"></span></a><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script><script src="/js/posfixed.js"></script><script src="/js/utils.js"></script><script src="/js/search.js"></script><script src="/js/tags_ball.js"></script><script>$.initTags(document.querySelector('#tags-ball canvas'), [{"name":"计算机","href":"/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/"},{"name":"操作系统","href":"/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"},{"name":"进程","href":"/tags/%E8%BF%9B%E7%A8%8B/"},{"name":"线程","href":"/tags/%E7%BA%BF%E7%A8%8B/"},{"name":"浏览器","href":"/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/"},{"name":"前端","href":"/tags/%E5%89%8D%E7%AB%AF/"},{"name":"WebSocket","href":"/tags/WebSocket/"},{"name":"HTML5","href":"/tags/HTML5/"},{"name":"Nginx","href":"/tags/Nginx/"},{"name":"Node.js","href":"/tags/Node-js/"},{"name":"TCP","href":"/tags/TCP/"},{"name":"算法","href":"/tags/%E7%AE%97%E6%B3%95/"},{"name":"react","href":"/tags/react/"}])
</script><!-- busuanzi--><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>